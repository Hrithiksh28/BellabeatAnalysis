---
title: "Bellabeat Device Usage Analysis"
author: "Hrithik Sharma"
date: "2023-10-02"
output: 
  html_document: 
    toc: true
---

```{r setup, include=FALSE}
options(repos = "https://cran.rstudio.com/")
library(dplyr)
```
# Introduction

In this case study, you step into the role of a junior data analyst at Bellabeat, a forward-thinking company specializing in health-focused smart products for women. Bellabeat, founded by Urška Sršen and Sando Mur, has made significant strides in the health technology industry, offering products that empower women with valuable insights into their activity, sleep, stress, and reproductive health. Despite their success, the company seeks to expand further in the global smart device market and believes that analyzing smart device fitness data can unlock new growth opportunities.

Your task as a data analyst is to focus on one of Bellabeat's products and thoroughly analyze the data generated by these smart devices. By dissecting how consumers are utilizing these devices, you aim to provide critical insights that will shape the company's marketing strategy. Bellabeat's CCO, Urška Sršen, is eager to leverage the available consumer data to uncover untapped growth potential. This analysis will help inform high-level recommendations for Bellabeat's marketing approach, allowing them to harness the power of data-driven insights to drive future success. As you embark on this case study, you will follow the data analysis process, from asking the right questions to sharing your findings and making actionable recommendations to the Bellabeat executive team.

# Set Up Business Objective
Identify trends in how consumers use non-Bellabeat smart devices to apply insights into Bellabeat’s marketing strategy.

**Stakeholders**

Urška Sršen - Bellabeat cofounder and Chief Creative Officer
Sando Mur - Bellabeat cofounder and key member of Bellabeat executive team
Bellabeat Marketing Analytics team


# Preparing and Sourcing the Dataset
## Installing Packages
```{r Installing Packages}
#Install and Load Packages
install.packages("tidyverse")
install.packages("dplyr")
install.packages("janitor")
install.packages("ggplot2")
install.packages("lubridate")

library(tidyverse)
library(dplyr)
library(janitor)
library(ggplot2)
library(lubridate)
```

## Importing Datasets
```{r Import Dataset 1}
daily_activity <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/dailyActivity_merged.csv")
head(daily_activity)
str(daily_activity)
```

```{r Import Dataset 2}
daily_calories <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/dailyCalories_merged.csv")
head(daily_calories)
str(daily_calories)
```

```{r Import Dataset 3}
daily_intensities <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/dailyIntensities_merged.csv")
head(daily_intensities)
str(daily_intensities)
```

```{r Import Dataset 4}
daily_steps <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/dailySteps_merged.csv")
head(daily_steps)
str(daily_steps)
```

```{r Import Dataset 5}
heartrate <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/heartrate_seconds_merged.csv")
head(heartrate)
str(heartrate)
```

```{r Import Dataset 6}
hourly_calories <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/hourlyCalories_merged.csv")
head(hourly_calories)
str(hourly_calories)
```

```{r Import Dataset 7}
hourly_intensities <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/hourlyIntensities_merged.csv")
head(hourly_intensities)
str(hourly_intensities)
```

```{r Import Dataset 8}
hourly_steps <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/hourlySteps_merged.csv")
head(hourly_steps)
str(hourly_steps)
```

```{r Import Dataset 9}
minute_steps <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/minuteStepsNarrow_merged.csv")
head(minute_steps)
str(minute_steps)
```

```{r Import Dataset 10}
minute_calories <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/minuteCaloriesNarrow_merged.csv")
head(minute_calories)
str(minute_calories)
```

```{r Import Dataset 11}
minute_intensities <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/minuteIntensitiesNarrow_merged.csv")
head(minute_intensities)
str(minute_intensities)
```

```{r Import Dataset 12}
minute_MET <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/minuteMETsNarrow_merged.csv")
head(minute_MET)
str(minute_MET)
```

```{r Import Dataset 13}
daily_sleep <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/sleepDay_merged.csv")
head(daily_sleep)
str(daily_sleep)
```

```{r Import Dataset 14}
weight_log <- read.csv("D:/Data_Analysis/BellabeatAnalysis/Data/weightLogInfo_merged.csv")
head(weight_log)
str(weight_log)
```

# Cleaning and Preparing Dataset
## Working with Day wise activities Dataset
### 1. Clean daily activity data frame
```{r Clean data 1, echo=TRUE, results='hide'}
#Clean daily_activity
daily_activity %>% 
  drop_na() %>% 
  select(-ActivityDate) %>% 
  select(-TotalSteps) %>% 
  select(-TrackerDistance)
```

### 2. Return only unique values
```{r Clean data 2, echo=TRUE, results='hide'}
daily_activity <- unique(daily_activity)
```

### 3. Add aditional data such as day, month and day of week for analysis
```{r add data 1}
#Extract day, month and year from ActivityDate (daily_activity)
daily_activity$ActivityDate <- as.Date(daily_activity$ActivityDate, format = "%m/%d/%Y")
daily_activity$day <- format(as.Date(daily_activity$ActivityDate), "%d")
daily_activity$month <- format(as.Date(daily_activity$ActivityDate), "%m")
daily_activity$day_of_week <- format(as.Date(daily_activity$ActivityDate), "%A")

str(daily_activity)
```
```{r, echo=TRUE, results='hide'}
clean_names(daily_activity)
```

## Working with Hour wise activities Dataset
### 1. Merge various hourly activity data frames into one data frames
```{r merge data 1}
#Merge hourly data as hourly_activity
hourly_activity <- merge(hourly_calories, hourly_intensities, by = c("Id", "ActivityHour"))
hourly_activity <- merge(hourly_activity, hourly_steps, by = c("Id", "ActivityHour"))
```

### 2. clean hourly activity data frame
```{r Clean data 3, echo=TRUE, results='hide'}
#clean hourly_activity
hourly_activity %>% 
  drop_na() %>% 
  select(-ActivityHour) %>% 
  select(-StepTotal)
```

### 3. Return unique values
```{r Clean data 4, echo=TRUE, results='hide'}
hourly_activity <- unique(hourly_activity)
```

### 4. Add aditional data such as day, month and day of week for analysis
```{r add data 2}
#Extract day, month, year, hour, mintues, seconds from ActivityHour (hourly_activity)
hourly_activity$ActivityHour <- format(strptime(hourly_activity$ActivityHour, "%m/%d/%Y %I:%M:%S %p"), "%d-%m-%Y %H:%M:%S")
hourly_activity$ActivityHour <- as.POSIXct(hourly_activity$ActivityHour, format = "%d-%m-%Y %H:%M:%S")
hourly_activity$day <- format(as.POSIXct(hourly_activity$ActivityHour), "%d")
hourly_activity$month <- format(as.POSIXct(hourly_activity$ActivityHour), "%m")
hourly_activity$hour <- format(as.POSIXct(hourly_activity$ActivityHour), "%H")
hourly_activity$day_of_week <- format(as.POSIXct(hourly_activity$ActivityHour), "%A")

str(hourly_activity)
```

## Working with minute wise activities dataset
### 1. Merge all minute wise activities into one data frame
```{r merge data 2}
#Merge Minute data as minute_activity
merge_1 <- merge(minute_calories, minute_intensities)
merge_2 <- merge(minute_MET, minute_steps)
minute_activity <- merge(merge_1, merge_2)
```

### 2. Clean minute activity data frame
```{r Clean data 5, echo=TRUE, results='hide'}
#clean minute_activity
minute_activity %>% 
  drop_na() %>% 
  select(-ActivityMinute) %>% 
  select(-Steps)
```

### 3. Return only unique values
```{r Clean data 6, echo=TRUE, results='hide'}
minute_activity <- unique(minute_activity)
```

### 4. Correct date format and extract data such as day, month, hour, minute for analysis
```{r add data 3}
#Extract day, month, year, hour, mintues, seconds from ActivityMinute (minute_activity)
minute_activity$ActivityMinute <- format(strptime(minute_activity$ActivityMinute, "%m/%d/%Y %I:%M:%S %p"), "%d-%m-%Y %H:%M:%S")
minute_activity$ActivityMinute <- as.POSIXct(minute_activity$ActivityMinute, format = "%d-%m-%Y %H:%M:%S")
minute_activity$day <- format(as.POSIXct(minute_activity$ActivityMinute), "%d")
minute_activity$month <- format(as.POSIXct(minute_activity$ActivityMinute), "%m")
minute_activity$hour <- format(as.POSIXct(minute_activity$ActivityMinute), "%H")
minute_activity$minute <- format(as.POSIXct(minute_activity$ActivityMinute), "%M")
minute_activity$ampm <- format(as.POSIXct(minute_activity$ActivityMinute), "%p")
minute_activity$day_of_week <- format(as.POSIXct(minute_activity$ActivityMinute), "%A")

str(minute_activity)
```

## Working with Sleep data
### 1. Prepare and Clean the data frame
```{r Clean data 7, echo=TRUE, results='hide'}
#Preparing and Cleaning Sleep Data
sleep_data <- daily_sleep %>%
  select(-TotalSleepRecords) %>%
  rename(ActivityDate = SleepDay) %>%
  distinct(Id, ActivityDate, TotalMinutesAsleep, TotalTimeInBed, .keep_all = TRUE)

```

### 2. Review the columns of data frame
```{r review data}
glimpse(sleep_data)
```

### 3. Correct the date format
```{r Clean data 8}
sleep_data$ActivityDate <- as.Date(sleep_data$ActivityDate, format = "%m/%d/%Y")
```

### 4. Merge sleep data with daily activity data frame
```{r merge data 3}
daily_activity_sleep <- merge(daily_activity, sleep_data, by = c("Id", "ActivityDate"))
```

## Working with Weight Data
### 1. Correct date format and extract data such as day, month, hour, minute for analysis
```{r add data 4}
#Extract date from time (weight_log)
weight_log$DateandTime <- format(strptime(weight_log$Date, "%m/%d/%Y %I:%M:%S %p"), "%d-%m-%Y %H:%M:%S")
weight_log$DateandTime <- as.POSIXct(weight_log$DateandTime, format = "%d-%m-%Y %H:%M:%S")
weight_log$Date <- as.POSIXct(weight_log$Date, format = "%m/%d/%Y")
weight_log$day <- format(as.POSIXct(weight_log$DateandTime), "%d")
weight_log$month <- format(as.POSIXct(weight_log$DateandTime), "%m")
weight_log$hour <- format(as.POSIXct(weight_log$DateandTime), "%H")
weight_log$minute <- format(as.POSIXct(weight_log$DateandTime), "%M")
weight_log$day_of_week <- format(as.POSIXct(weight_log$DateandTime), "%A")
```

### 2. Prepare and Clean Weight Data
```{r Clean data 9, echo=TRUE, results='hide'}
weight_data <- weight_log %>% 
  select(-WeightPounds) %>% 
  rename(ActivityDate = Date) %>% 
  distinct(Id, ActivityDate, IsManualReport, day_of_week, .keep_all = TRUE)
```

### 3. Merge wight data with daily activity data
```{r merge data 4}
daily_activity_weight <- merge(daily_activity, weight_data, by = c("Id", "ActivityDate"))
```

## Working with Heartrate Data
### 1. Correct date format and extract data such as day, month, hour, minute for analysis
```{r add data 5}
#Extract seconds from Time (seconds_heartrate)
heartrate$DateandTime <- format(strptime(heartrate$Time, "%m/%d/%Y %I:%M:%S %p"), "%d-%m-%Y %H:%M:%S")
heartrate$DateandTime <- as.POSIXct(heartrate$DateandTime, format = "%d-%m-%Y %H:%M:%S")
heartrate$second <- format(as.POSIXct(heartrate$DateandTime), "%S")
heartrate$day <- format(as.POSIXct(heartrate$DateandTime), "%d")
heartrate$month <- format(as.POSIXct(heartrate$DateandTime), "%m")
heartrate$hour <- format(as.POSIXct(heartrate$DateandTime), "%H")
heartrate$minute <- format(as.POSIXct(heartrate$DateandTime), "%M")
str(heartrate) 
```

### 2. Clean the data by removing junk Data
```{r Clean data 10}
flt_heartrate <- heartrate[grep("00", heartrate$second), ]
```

### 3. Prepare data
```{r Clean data 11, echo=TRUE, results='hide'}
heartrate_data <- flt_heartrate %>% 
  rename(ActivityMinute = DateandTime) %>% 
  distinct(Id, ActivityMinute, Value, minute, day, month, .keep_all = TRUE)
```

### 4. Merge hearrate data with minute activity data frame
```{r merge data 5}
minute_activity_hr <- merge(minute_activity, heartrate_data, by = c("Id", "ActivityMinute", "day", "month", "minute"))
```

# Processing Data
## Order Data
### 1. Order the Week Day in Daily Activity Data frame
```{r prepare data}
#Order the Day of Week
daily_activity$day_of_week <- ordered(daily_activity$day_of_week, levels=c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))

```

## Additional Data Frames
### 1. Addtional Data frame extracted from hourly activity
```{r data frame 1}
#Average intensity per hour
add_data_1 <- hourly_activity %>%
  group_by(hour) %>%
  drop_na() %>% 
  summarise(avg_intensity = mean(TotalIntensity), 
            avg_calories = mean(Calories),
            avg_steps = mean(StepTotal))

```

### 2. Addtional Data frame extracted from daily sleep activity
```{r data frame 2}
#additional data frame from daily activity with sleep data
add_data_2 <- daily_activity_sleep %>%
  group_by(day_of_week, day, month) %>% 
  summarise(avg_steps = mean(TotalSteps),
            avg_distance = mean(TotalDistance),
            avg_vad = mean(VeryActiveDistance),
            avg_mad = mean(ModeratelyActiveDistance),
            avg_lad = mean(LightActiveDistance),
            avg_sad = mean(SedentaryActiveDistance),
            avg_vam = mean(VeryActiveMinutes),
            avg_fam = mean(FairlyActiveMinutes),
            avg_lam = mean(LightlyActiveMinutes),
            avg_sam = mean(SedentaryMinutes),
            avg_calories = mean(Calories),
            avg_sleep = mean(TotalMinutesAsleep),
            avg_bed = mean(TotalTimeInBed))
```

### 3. Additional Data frame extraced from weight data frame
```{r data frame 7}
# additional data frame from weight_log
add_data_4 <- weight_log %>% 
  group_by(DateandTime, IsManualReport) %>% 
  summarise(avg_weight = mean(WeightKg))

```

### 4. Additional Data Frame extracted from daily activity data frame
```{r data frame 8}
add_data_5 <- daily_activity %>% 
  group_by(day_of_week) %>% 
  summarise(average_steps = mean(TotalSteps),
            average_distance = mean(TotalDistance),
            average_calories = mean(Calories),
            average_steps = mean(TotalSteps))
```

### 5. Additional Data Frame extracted from minute activity data frame include heartrate data
```{r data frame 9}
#additional data frame 6 from minute activity data with heartrate data
add_data_6 <- minute_activity_hr %>% 
  group_by(minute, ActivityMinute) %>% 
  summarise(avg_steps = mean(Steps),
            avg_calories = mean(Calories),
            avg_hr = mean(Value),
            max_hr = max(avg_hr), 
            min_hr = min(avg_hr),
            avg_met = mean(METs))

```

## Pivot Tables
### 1. Pivot table to  implement a customize legend labels (For different Active Distances)
```{r data frame 3}
add_data_2_dis <- add_data_2 %>% 
  pivot_longer(cols = c(avg_vad, avg_mad, avg_lad, avg_sad),
               names_to = "Activity",
               values_to = "Average_Distance")

```

### 2.Pivot table to  implement a customize legend labels (For different Active Minutes)
```{r data frame 5}
add_data_2_min <- add_data_2 %>% 
  pivot_longer(cols = c(avg_vam, avg_fam, avg_lam, avg_sam),
               names_to = "Activity2",
               values_to = "Average_Distance")
```

## Assigning Custom Colors
### 1. Custom colors assigned to custom legend labels (For different Active Distances)
```{r data frame 4}
custom_colors <- c("avg_vad" = "blue", "avg_mad" = "darkgreen", "avg_lad" = "orange", "avg_sad" = "red")
```

### 2.Custom colors assigned to custom legend labels (For different Active Minutes)
```{r data frame 6}
custom_colors2 <- c("avg_vam" = "blue", "avg_fam" = "darkgreen", "avg_lam" = "orange", "avg_sam" = "red")
```

# Analyising Data
## 1. Total Steps Vs Total Calories Graph
```{r Graph 1}
#Total Steps vs Calories graph
daily_activity %>% ggplot(aes(x = TotalSteps, y = Calories))+
  geom_jitter() + 
  geom_smooth() + 
  labs(title="Total Steps vs. Calories",
       x = "Total Steps", y = "Total Calories")
```

## 2. Total Minutes Asleep vs Total Time in Bed graph
```{r Graph 2}
#Total Minutes Asleep vs Total Time in Bed graph
daily_activity_sleep %>% ggplot(aes(x = TotalMinutesAsleep, y = TotalTimeInBed))+
  geom_jitter(color ="darkgreen", alpha = 0.5, size = 2.25)+
  geom_smooth()+
  labs(title = "Total Minutes Asleep vs Total Time in Bed",
       x = "Total Minutes Asleep", y = "Total Time in bed")
```

## 3. Average Total Intensity vs. Time Graph
```{r Graph 3}
#Average Total Intensity vs. Time
add_data_1 %>% ggplot(aes(x = hour, y = avg_intensity))+
  geom_histogram(stat = "identity", fill = "#66A61E", bins = 30)+
  labs(title="Average Intensity vs. Time",
       x = "Time (Hour 24H)", y = "Average Intensity")
```

## 4. Average Calories vs. Time Graph
```{r Graph 4}
#Average Calories vs. Time
add_data_1 %>% ggplot(aes(x = hour, y = avg_calories))+
  geom_histogram(stat = "identity", fill = "#66A61E")+
  labs(title="Average Calories vs. Time",
       x = "Time (Hour 24H)", y = "Average Calories")
```

## 5. Average Steps vs. Time Graph
```{r Graph 5}
#Average Steps vs. Time
add_data_1 %>% ggplot(aes(x = hour, y = avg_steps))+
  geom_histogram(stat = "identity", fill = "#66A61E")+
  labs(title="Average Steps vs. Time",
       x = "Time (Hour 24H)", y = "Average Steps")
```

## 6. Average Calories vs. Time Graph Filtered by Average Intensity
```{r Graph 6}
#Average Calories vs. Time
add_data_1 %>% ggplot(aes(x = hour, y = avg_calories, fill = avg_intensity))+
  geom_col()+
  labs(x="Time (hour 24H)", y = "Average Calories", 
       title="Average Calories vs. Time  Filtered by Average Intensity", 
       fill = "Average Intensity")+
  scale_fill_gradient(low = "#FF5733", high = "#66A61E")
```

## 7. Average Steps vs. Time Graph Filtered by Average Intensity
```{r Graph 7}
#Average Steps vs. Time
add_data_1 %>% ggplot(aes(x = hour, y = avg_steps, fill = avg_intensity))+
  geom_col()+
  labs(x="Time (hour 24H)", y = "Average Steps", 
       title="Average Steps vs. Time segmented by Average Intensity", 
       fill = "Average Intensity")+
  scale_fill_gradient(low = "#FF5733", high = "#66A61E")
add_data_2_dis %>% ggplot(aes(x = day_of_week, y = avg_distance, fill = Activity))+
  geom_col()+
  labs(x="Day", y = "Average Distance", 
       title="Average Steps vs. Time segmented by Distances", 
       fill = "Distances")+
  scale_fill_manual(
    breaks = names(custom_colors),
    values = custom_colors,
    labels = c("Very Active", "Moderately Active", "Lightly Active", "Sedentary Activity")
  )
```

## 8. Average Duration vs. Time segmented by Distances Graph
```{r Graph 8}
add_data_2_min %>% ggplot(aes(x = day_of_week, y = avg_distance, fill = Activity2))+
  geom_col()+
  labs(x="Day", y = "Average Distance", 
       title="Average Duration vs. Time segmented by Distances", 
       fill = "Duration")+
  scale_fill_manual(
    breaks = names(custom_colors2),
    values = custom_colors2,
    labels = c("Very Active", "Moderately Active", "Lightly Active", "Sedentary Active")
  )
```

## 9. Manually reported vs Machine reported weight Graph
```{r Graph 9}
#Line Graph to represent Users Manually reported vs Machine reported weight
add_data_4 %>% ggplot(aes(x = DateandTime, y = avg_weight, color = IsManualReport))+
  geom_line()+
  geom_point()+
  labs(
    title = "Manually Vs Machine Reported Weight by Users",
    x = "Time", y = "Average Weight",
    color = "Weight Reported"
  )+
  scale_color_manual(
    values = c("False" = "red", "True" = "darkgreen"),
    labels = c("Manual Weight", "Machine Weight")
  )
```

## 10. Average Steps per Day of Week Graph
```{r Graph 10}
add_data_5 %>% ggplot(aes(x = day_of_week, y = average_steps)) + 
  geom_col(position = "dodge", fill = "#66A61E") +
  labs(
    title = "Average Steps per Day of Week",
    x = "Day of Week", y = "Average Steps"
  )
``` 

## 11. Average Distance per Day of Week Graph
```{r Graph 11}
add_data_5 %>% ggplot(aes(x = day_of_week, y = average_distance)) + geom_col(position = "dodge", fill = "#66A61E")+
  labs(
    title = "Average Distance per Day of Week",
    x = "Day of Week", y = "Average Steps"
  )
```

## 12. Average Calories per Day of Week Graph
```{r Graph 12}
add_data_5 %>% ggplot(aes(x = day_of_week, y = average_calories)) + geom_col(position = "dodge", fill = "#66A61E")+
  labs(
    title = "Average Calories per Day of Week",
    x = "Day of Week", y = "Average Steps"
  )
```

## 13. Average Heartrate per Average Calorie Burned Graph
```{r Graph 13}
add_data_6 %>% ggplot(aes(x = avg_calories, y = avg_hr))+
  geom_point(alpha = 0.5, color = "#66A61E")+
  geom_smooth()+
  labs(title = "Average Heartrate per Average Calorie Burned",
       x = "Average Calories", y = "Average Heartrate")
```

## 14. Average Heartrate Vs Average Steps Graph
```{r Graph 14}
add_data_6 %>% ggplot(aes(x = avg_steps, y = avg_hr))+
  geom_point(alpha = 0.5, color = "#66A61E")+
  geom_smooth()+
  labs(title = "Average Heartrate Vs Average Steps",
       x = "Average Steps", y = "Average Heartrate")
```

## 15. Average Heartrate Vs Average Metabolic Equivalent(MET) Graph
```{r Graph 15}
add_data_6 %>% ggplot(aes(x = avg_met, y = avg_hr))+
  geom_point(alpha = 0.5, color = "#66A61E")+
  geom_smooth()+
  labs(title = "Average Heartrate Vs Average Metabolic Equivalent(MET)",
       x = "Average Metabolic Equivalent(MET)", y = "Average Heartrate")
```

## 16. Average Heartrate range every Minute minute Graph
```{r Graph 16}
add_data_6 %>% ggplot(aes(x = minute, y = avg_hr))+
  geom_line()+
  geom_point(color = "#66A61E", alpha = 0.5)+
  labs(title = "Average Heartrate range every Minute",
       x = "Time (Minute)", y = "Average Heartrate")+
  theme_minimal()
```

## 17. Average Heartrate range every minute Graph
```{r Graph 17}
add_data_6 %>% ggplot(aes(x = minute, y = avg_steps))+
  geom_line()+
  geom_point(color = "#66A61E", alpha = 0.5)+
  labs(title = "Average Heartrate range every minute",
       x = "Time (Minute)", y = "Average Heartrate")+
  theme_minimal() 
```

## 18. Average Heartrate range every minute Graph
```{r Graph 18}
add_data_6 %>% ggplot(aes(x = minute, y = avg_calories))+
  geom_line()+
  geom_point(color = "#66A61E", alpha = 0.5)+
  labs(title = "Average Heartrate range every minute",
       x = "Time (Minute)", y = "Average Heartrate")
```

## 19. Average Heartrate range every minute Graph
```{r Graph 19}
add_data_6 %>% ggplot(aes(x = minute, y = avg_met))+
  geom_line()+
  geom_point(color = "#66A61E", alpha = 0.5)+
  labs(title = "Average Heartrate range every minute",
       x = "Time (Minute)", y = "Average Heartrate")
```

## 20. Average Calories Vs Average METs Graph
```{r Graph 20}
#Graph 8
add_data_6 %>% ggplot(aes(x = avg_calories, y = avg_met))+
  geom_hex(bins = 20, color = "white") +
  geom_smooth()+
  labs(title = "Average Calories Vs Average METs",
       x = "Average Calories", y = "Average METs",
       fill = "Metabolic Equivalent (MET) count")+
  scale_fill_gradient(
    low = "red", high = "darkgreen"
  )+
  theme_minimal()
```

## 21. Average Steps Vs. Average METs Graph
```{r Graph 21}
add_data_6 %>% ggplot(aes(x = avg_steps, y = avg_met))+
  geom_hex(bins = 20, color = "white") +
  geom_smooth()+
  labs(title = "Average Steps Vs. Average METs",
       x = "Average Steps", y = "Average METs",
       fill = "Metabolic Equivalent (MET) count")+
  scale_fill_gradient(
    low = "red", high = "darkgreen"
  )+
  theme_minimal()
```

## 22. Average heartrate Vs. Average METs Graph
```{r Graph 22}
add_data_6 %>% ggplot(aes(x = avg_hr, y = avg_met))+
  geom_hex(bins = 20, color = "white") +
  geom_smooth()+
  labs(title = "Average heartrate Vs. Average METs",
       x = "Average heartrate", y = "Average METs",
       fill = "Metabolic Equivalent (MET) count")+
  scale_fill_gradient(
    low = "red", high = "darkgreen"
  )+
  theme_minimal()
```

